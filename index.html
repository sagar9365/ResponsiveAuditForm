<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Inventory QC Form</title>

<!-- Select2 CSS & JS -->
<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

<!-- html5-qrcode -->
<script src="https://unpkg.com/html5-qrcode"></script>

<style>
body { font-family: Arial; margin: 20px; background: #f9f9f9; color:#222; transition:0.3s;}
body.dark { background:#121212; color:#eee;}
.form-container { max-width:600px; margin:auto; background:#fff; padding:20px; border-radius:10px; box-shadow:0 2px 8px rgba(0,0,0,0.15);}
body.dark .form-container { background:#1e1e1e;}
label { font-weight:bold; margin-top:10px; display:block;}
input, select { width:100%; padding:8px; margin-top:5px; border:1px solid #ccc; border-radius:5px; }
button { margin-top:15px; padding:10px; background:#007bff; border:none; color:#fff; border-radius:5px; cursor:pointer; width:100%;}
button:hover { background:#0056b3;}

.scanner-modal { display:none; position:fixed; top:0; left:0; right:0; bottom:0; background: rgba(0,0,0,0.8); z-index:1000; justify-content:center; align-items:center;}
.scanner-box { width:300px; height:300px; background:#000; border-radius:10px; }
.close-btn { margin-top:10px; padding:6px 12px; background:red; border:none; color:#fff; border-radius:5px; cursor:pointer; }

.dark-toggle { margin-bottom:15px; }
</style>
</head>
<body>

<button class="dark-toggle" onclick="toggleDark()">ðŸŒ™ Dark Mode</button>

<div class="form-container">
<h2>Inventory QC Form</h2>

<label>DH Name</label>
<select id="dhName" required>
  <option value="">Select DH</option>
  <option>BLR-BTM-2</option>
  <option>BLR-BTM LAYOUT NEW</option>
  <option>BLR-RICHMOND TOWN</option>
  <option>BLR-JP Nagar</option>
  <option>BLR-BANASHANKARI</option>
  <option>BLR-Mathikere</option>
  <option>BLR-Kalyan Nagar Network</option>
  <option>BLR-Chickpet New</option>
  <option>BLR-SHIVAJI NAGAR</option>
  <option>BLR-Cholayakanakalli</option>
  <option>BLR-Jakkur New</option>
  <option>BLR-Jakkur Network</option>
  <option>BLR-HEBBAL NEW</option>
  <option>BLR-Nikoo Home New</option>
  <option>BLR-TC Palaya</option>
  <option>BLR-Devanahalli</option>
  <option>BLR-Yelahanka Network</option>
  <option>BLR-Nehru Nagar</option>
  <option>BLR-GUNJUR</option>
  <option>BLR-HSR-3</option>
  <option>BLR-Narayana reddy Layout</option>
  <option>BLR-Kannika Nagar</option>
  <option>BLR-GUNJUR Network</option>
  <option>BLR-Mico layout network-2</option>
  <option>BLR-Bannerghatta Network 2</option>
  <option>BLR-BANNERGHATTA</option>
  <option>BLR-Kambhipura</option>
  <option>BLR-JP NAGAR New</option>
  <option>BLR-KALYAN NAGAR NEW</option>
  <option>BLR-Challakere</option>
  <option>BLR-Koramangala Network</option>
  <option>BLR-Hennur New</option>
  <option>BLR-Dasarahalli</option>
  <option>BLR-SHIVAJI NAGAR Network</option>
  <option>BLR-Margosa road</option>
  <option>BLR-Banjara Layout</option>
  <option>BLR-Ramamurthy Nagar Network</option>
  <option>BLR-BASAVANAPURA NETWORK 2</option>
  <option>BLR-Bagalur</option>
  <option>BLR-RWF Yelahanka</option>
  <option>Sanjaynagar</option>
  <option>BLR-BHADRAPPA LAYOUT NETWORK</option>
  <option>BLR-Bhadrapppa Layout</option>
  <option>BLR-HBR Layout</option>
  <option>BLR-Dooravani Nagar</option>
  <option>BLR-Nagavara</option>
  <option>BLR-Narayanapura</option>
  <option>BLR-YELAHANKA</option>
  <option>BLR-Kasturinagar</option>
  <option>BLR-Vidyaranyapura</option>
  <option>BLR-Kogilu Road</option>
  <option>BLR-Narayanapura Network</option>
  <option>BLR-INDIRANAGAR NEW</option>
  <option>BLR-Malleshwaram new</option>
  <option>BLR-RAMAMURTHY NAGAR NEW</option>
</select>

<label>LPN Number</label>
<div style="display:flex; gap:5px;">
  <input type="text" id="lpnNumber" required>
  <button type="button" onclick="openScanner('lpnNumber')">ðŸ“·</button>
</div>

<label>LPN Qty</label>
<input type="number" id="lpnQty" required>

<label>Physical Qty</label>
<input type="number" id="phyQty" required>

<label>Difference Qty</label>
<input type="number" id="diffQty" readonly>

<label>Suggest / Remarks</label>
<select id="remarks">
  <option>Equal</option>
  <option>Short</option>
  <option>Excess</option>
</select>

<label>Condition</label>
<select id="condition">
  <option selected>Good</option>
  <option>Damage</option>
  <option>Mismatch</option>
</select>

<label>SKU</label>
<div style="display:flex; gap:5px;">
  <input type="text" id="sku">
  <button type="button" onclick="openScanner('sku')">ðŸ“·</button>
</div>

<label>Price</label>
<input type="number" id="price">

<label>Total Value</label>
<input type="number" id="totalValue" readonly>

<label>Status</label>
<select id="status">
  <option>Non QC</option>
  <option>QC Done</option>
</select>

<label>Employee Name</label>
<input type="text" id="empName" required>

<label>Auditor Name</label>
<select id="auditor">
  <option value="">Select Auditor</option>
  <option>Arjun MY</option>
  <option>Kishor Pandit</option>
  <option>Jeet Kumar</option>
  <option>Sagar Pandit</option>
</select>

<button type="submit">Submit</button>

</div>

<!-- Scanner Modal -->
<div id="scannerModal" class="scanner-modal">
  <div>
    <div id="reader" class="scanner-box"></div>
  </div>
</div>

<script>
$(document).ready(function() {
  $("#dhName").select2({ placeholder: "Search DH Name", width:'100%' });
});

// Dark mode toggle
function toggleDark(){ document.body.classList.toggle("dark"); }

// Calculation functions
function calcDiff(){
  let lpn= +document.getElementById("lpnQty").value||0;
  let phy= +document.getElementById("phyQty").value||0;
  let diff = Math.abs(lpn - phy);
  document.getElementById("diffQty").value = diff;
  let remark = "Equal";
  if(lpn>phy) remark="Short";
  else if(lpn<phy) remark="Excess";
  document.getElementById("remarks").value = remark;
  calcValue();
}
function calcValue(){
  let diff = +document.getElementById("diffQty").value||0;
  let price = +document.getElementById("price").value||0;
  document.getElementById("totalValue").value = diff*price;
}
document.getElementById("lpnQty").addEventListener("input",calcDiff);
document.getElementById("phyQty").addEventListener("input",calcDiff);
document.getElementById("price").addEventListener("input",calcValue);

// Scanner functions
let scanner;
let currentField;
function openScanner(fieldId){
  currentField = fieldId;

  if(scanner){ // stop previous scanner if running
    scanner.stop().then(()=>scanner.clear());
  }

  document.getElementById("scannerModal").style.display="flex";

  scanner = new Html5Qrcode("reader");
  scanner.start(
    { facingMode: { exact: "environment" } },
    { fps:20, qrbox:250 },
    (decodedText)=>{
      document.getElementById(currentField).value = decodedText;
      closeScanner();
    },
    (err)=>{}
  ).catch(err=>{ alert("Camera error: "+err); });
}

function closeScanner(){
  if(scanner){
    scanner.stop().then(()=>scanner.clear()).catch(()=>{});
    scanner=null;
  }
  document.getElementById("scannerModal").style.display="none";
}

// Click outside scanner to close
document.getElementById("scannerModal").addEventListener("click",function(e){
  if(e.target===this){ closeScanner(); }
});
</script>

</body>
</html>
